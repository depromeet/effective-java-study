# Item 15. 클래스와 멤버의 접근 권한을 최소화하라

### 잘 설계된 컴포넌트

-   클래스 내부 데이터와 구현 정보를 외부로부터 잘 숨김
-   오직 API를 통해서 다른 컴포넌트와 소통 (서로 내부 동작 방식을 모름)

👉 `정보 은닉`, `캡슐화`가 중요

<br/>

### 정보 은닉이란?

-   다른 객체에게 자신의 정보를 숨기고 자신의 연산만을 통해 접근을 허용하는 것
-   여러 컴포넌트를 병렬로 개발 가능 👉 시스템 개발 속도↑
-   각 컴포넌트를 더 빨리 파악할 수 있고 교체 부담도 적음 👉 시스템 관리 비용 ↓
-   성능 최적화에 도움
-   소프트웨어의 재사용성 ↑

<br/>

### <u>모든 클래스와 멤버의 접근성을 가능한 좁혀야 한다!</u>

> Java 의 필드와 메소드들에 대한 접근 권한 제어를 modifier 라고 한다.

| 접근 수준 | 클래스 내부 | 동일 패키지 | 상속 관계 | 모든 곳에서 |
| --------- | ----------- | ----------- | --------- | ----------- |
| private   | O           | X           | X         | X           |
| default   | O           | O           | X         | X           |
| protected | O           | O           | O         | X           |
| public    | O           | O           | O         | O           |

-   `private`: 가장 좁은 범위를 가지며, 해당 클래스 내부에서만 접근이 가능합니다. 다른 클래스에서는 접근할 수 없습니다. 클래스 내부의 필드와 메서드에 주로 사용됩니다.

-   `default` (package-private): 접근 제한자를 명시하지 않았을 때 기본적으로 적용되는 접근 수준입니다. 동일한 패키지 내에서만 접근이 가능하고, 다른 패키지에서는 접근할 수 없습니다. 일반적으로 패키지 내부에서만 사용할 목적으로 설정합니다.

-   `protected`: 동일한 패키지 내에서는 default와 동일하게 접근이 가능하며, 다른 패키지에서도 상속 관계에 있는 하위 클래스에서 접근이 가능합니다. 상속 관계가 아닌 클래스나 패키지 외부에서는 접근할 수 없습니다.

-   `public`: 가장 넓은 범위를 가지며, 어느 곳에서나 접근이 가능합니다. 모든 클래스와 패키지에서 접근할 수 있으며, 외부에서 해당 클래스의 인스턴스를 생성하고 메서드를 호출할 수 있습니다.

<br/>

### Comments

**권한 풀어주기**

-   권한을 풀어주는 일이 지나치게 많아지면 컴포넌트를 더 분리해야하는 것이 아닌지 고민해야 한다.

**멤버와 공개 API**

-   protected와 public은 해당 클래스의 구현을 벗어나 공개 API에 영향을 줄 수 있다.
-   내부 동작 방식을 API 문서에 적어 사용자에게 공개하는 경우도 생긴다.
-   private와 package-private는 내부 구현용이지만 예외적으로 Serializable을 직접 구현한 클래스에서는 공개 API가 될 수도 있다.

**멤버 접근성의 제약**

-   상위 클래스의 메소드를 재정의하는 경우, 그 접근 수준을 상위 클래스보다 좁게 설정할 수 없다.
-   이 규칙을 어기면 컴파일 오류가 발생한다.

**public 클래스의 인스턴스 필드**

-   public 클래스의 인스턴스 필드가 public이면 필드가 언제든지 가변될 수 있다.
-   클래스에 길이가 0이 아닌 public static final배열 필드를 두거나 이 필드를 반환하는 접근자 메서드를 제공하면 안된다.
    -   배열의 내용이 수정될 수 있기 때문에
    -   public static final 필드가 참조하는 객체가 불변인지 확인할 것

```java
public class A {
  public final int[] arr = {1, 2, 3};
}

@Test
public void test() {
  A a = new A();
  a.arr[1] = 3;
  assertThat(a.arr[1]).isNotEqualTo(2);
}
```

**접근성**

-   테스트를 위한 접근성 확장
-   테스트 목적으로 접근 범위를 넓히는 경우가 있다.
-   `private` 멤버를 `default`로 풀어주는 정도까지는 괜찮지만 이를 `protected`, `public`까지 푸는 것은 문제가 있다.

**모듈**

-   자바 9부터 도입된 모듈 시스템은 기존의 클래스패스(classpath) 방식에서 모듈패스(module path) 방식으로 프로젝트를 구성할 수 있게 해주는 기능
-   모듈 시스템을 사용하면 프로젝트를 더욱 구조적이고 격리된 단위로 분리할 수 있음
-   관련된 패키지, 클래스, 리소스 등을 묶어서 논리적으로 구조화한 것을 말함
-   간단히 말하면, 프로젝트를 조직화하여 논리적인 모듈로 분리하고 해당 모듈 간에 공개 및 접근 권한을 지정할 수 있도록 하는 기능

<br/>

### Appendix

-   protected의 경우는 좀 애매하게 보일 수 있다. 왜냐하면 사실상 그 기능은 public과 같은 역할을 하기 때문
-   클래스의 메소드를 직접 instance를 만들어 사용할 수는 없지만, 상속을 하는 클래스만 만들면 자유롭게 사용이 가능하기 때문이다
-   실제로 부모와 동일한 기능을 할수 있도록 만들어주는데, protected와 public다를 바가 없어 보임
-   그러나 사실 protected는 많은 의미를 내포하는 메소드
-   protected 는 잠재적으로 자식 클래스가 Override해서 바꾸어야 할 경우를 고려한 modifier
-   즉 완성되지 못한, 혹은 완성될 수 없는 클래스 멤버를 의미
-   여기서 `완성되지 못한/완성될 수 없는`의 의미가 중요
-   클래스를 디자인한 개발자가 이 메소드에 대해서 앞으로 더 구현할 것이 남았다거나, 혹은 디자인 컨셉트로서 일부러 완성시키지 않은 경우 둘 다를 의미
